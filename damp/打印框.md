目标： 在执行打印或导出操作前，为用户提供一个模态对话框（Modal Dialog）。此界面允许用户：

预览： 准确预览将要生成的单个或批量标签。

配置： 设置导出的格式、范围、份数和排版方式。

执行： 确认并执行最终的打印或导出（下载）操作。

2. 触发条件
用户在主编辑器 (MainWindow) 中点击“打印”或“导出”按钮时，弹出此对话框。

对话框需要知道是单个任务（来自当前画布设计）还是批量任务（来自数据库打印功能）。

3. 布局结构
界面为一个固定大小（或可拉伸）的模态对话框。

采用两栏布局：

左侧预览区（约 40% 宽度）： 专注于视觉预览。

右侧设置区（约 60% 宽度）： 专注于参数配置。

4. 详细组件需求 - 左侧预览区
4.1 作品预览 (PreviewCanvas)
组件： 一个 QGraphicsView 或一个带边框的 QLabel。

功能： 居中显示一个标签的高保真渲染。

状态：

单模式： 始终显示当前画布的设计。

批量模式： 显示由下方“批量分页器 (4.4)”当前选中的标签（例如，第 2/8 个）。

4.2 预览工具栏 (PreviewToolbar)
位置： 位于 PreviewCanvas 的右上方。

组件： 一组 QToolButton。

控件：

适应画布 (Fit to View): 将预览缩放到最适合 PreviewCanvas 的大小。

缩小 (Zoom Out): 缩小预览。

放大 (Zoom In): 放大预览。

4.3 状态信息 (InfoPanel)
位置： PreviewCanvas 的左下方。

组件： 两个 QLabel。

内容 (动态)：

"尺寸: [W]mm × [H]mm" （例如："尺寸: 40mm × 35mm"）

"份数: [N]" （例如："份数: 1" 或 "份数: 8"）

[N] 的值决定了该对话框处于“单模式”还是“批量模式”。

4.4 批量分页器 (BatchNavigator) - 动态组件
位置： PreviewCanvas 的正下方。

可见性： 仅在“批量模式”下（即 "份数" > 1）时显示。 在“单模式”时隐藏。

组件： QHBoxLayout 包含 QToolButton (用于 "<" 和 ">") 和 QPushButton (用于页码)。

功能：

允许用户在批量任务的不同标签之间切换预览。

点击 "2" 时，PreviewCanvas (4.1) 必须立即更新以显示第 2 个标签的内容。

当标签数量过多时，应显示 "..." 省略号。

4.5 页面分页器 (PageNavigator) - 动态组件
位置： 整个左侧面板的最底部。

可见性： 仅在右侧的“导出方式”选择了会导致多页输出（例如 "A4排版"）时显示。

组件： QLabel ("前往")、QLineEdit (页码输入)、QLabel ("页")。

功能： 允许用户跳转预览最终生成的 PDF 或打印页。

(注：这与 (4.4) 的“标签分页器”是不同维度的功能。)

1. 详细组件需求 - 右侧设置区
5.1 文件类型 (FileType)
组件： QFormLayout 布局，包含 QLabel ("文件类型") 和 QComboBox。

选项： "PDF", "PNG", "JPEG", "ZPL" (用于热敏打印机) 等。

联动：

如果选择 "PDF"，则 (5.2) 中显示 "合并导出" / "分别导出"。

如果选择 "PNG"，则 (5.2) 自动设为 "分别导出"。

5.2 尺寸/纸张 (PageSize)
组件： (在 "文件类型" 同一行) QComboBox。

选项： "原尺寸", "A4 (210×297mm)", "A5 (148×210mm)" 等。

联动：

如果选择 "原尺寸"，(5.5) 中的 "排版导出" 按钮应被禁用。

如果选择 "A4"，"排版导出" 按钮应被启用。

5.3 导出方式 (ExportMode)
组件： QFormLayout 布局，包含 QLabel ("导出方式") 和 QComboBox。

选项 (动态)：

情景1 (默认): "合并导出" (所有标签在一个多页 PDF 中)

情景2: "分别导出" (每个标签一个单独的文件，如 label-1.png, label-2.png)

情景3 (当选择A4纸时): "自动排版" (在一个A4页面上尽可能多地排列标签)

5.4 导出/打印范围 (ExportRange) - 动态组件
组件： QFormLayout 布局，包含 QLabel ("导出/打印范围") 和一个 QHBoxLayout。

布局： QSpinBox (起始) - QLabel ("-") - QSpinBox (结束)。

可见性： 仅在“批量模式”下（即 "份数" > 1）时显示。 在“单模式”时隐藏。

逻辑：

起始 SpinBox: 最小值 1，最大值 N，默认值 1。

结束 SpinBox: 最小值 (起始 SpinBox 的值)，最大值 N，默认值 N。

[N] 是 "份数"。

5.5 导出份数 (CopyCount)
组件： QFormLayout 布局，包含 QLabel ("导出份数") 和 QSpinBox。

功能： 设置整套打印任务的重复次数。例如，范围 1-8，份数 2，则总共打印 16 个标签。

逻辑： 最小值 1，默认值 1。

5.6 次要操作 (SecondaryActions)
组件： QHBoxLayout 包含两个 QPushButton (使用次要样式，例如浅色背景和彩色边框)。

控件：

"排版导出": 预览或执行在 A4 纸上的排版。

"打印作品": 直接调起系统打印机对话框。

状态： 初始时可以为禁用状态，根据 (5.2) 和 (5.3) 的选择来启用。

5.7 主要操作 (PrimaryAction)
组件： QPushButton (使用主要样式，例如绿色填充)。

控件： "下载作品" (或根据上下文改为 "确认打印")。

功能： 这是最终的确认按钮，点击后开始执行导出或打印任务。