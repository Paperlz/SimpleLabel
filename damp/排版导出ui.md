功能名称： 排版设置 (LayoutSettingsDialog) 目标： 提供一个可视化的配置界面，允许用户精确定义多个标签在单张大纸上的排列方式（行、列、边距），并实时预览排版效果。 触发时机： 当用户在“打印与导出预览”对话框 (image_3306a6.png) 中点击 "排版导出" 按钮时，或者当用户在“尺寸”下拉菜单中选择了 "A4" 等非 "原尺寸" 纸张时，应显示此设置界面（或使配置按钮可用）。

2.0 界面布局
界面为一个模态对话框（Modal Dialog）。

采用两栏布局：

左侧： 实时预览区，用于直观展示排版网格。

右侧： 参数配置区，用于所有数值和选项的调整。

3.0 左侧 - 实时预览区
FR3.1: 页面画布

组件： 一个只读的画布（例如 QWidget 或 QGraphicsView）。

功能： 必须根据右侧 "页面大小" 和 "竖版/横版" 的选择，按比例绘制出目标纸张的线框（例如 A4 竖版）。

FR3.2: 排版网格

组件： 在画布上绘制的网格线。

功能： 此网格必须根据右侧 "每页显示行数" 和 "每页显示列数"（截图中的“每行显示个数”应为“列数”）的设置实时更新。

联动： 网格的整体外边界必须响应 "页面边距" 的设置；网格内部的单元格必须响应 "格子边距" 的设置。

FR3.3: 动态信息反馈

组件： 位于画布下方的 QLabel 文本块。

功能： 此文本必须在右侧参数发生任何变化时立即更新。

内容：

"每页显示：[N]行[M]列，共[N*M]个"（例如："5行4列，共20个"）

"页面大小：宽 [W]mm × 高 [H]mm"（例如："宽 210mm × 高 297mm"）

"页面数量：[P]页"（此数量需要根据 "总标签数" / (N*M) 来计算得出）

4.0 右侧 - 参数配置区
FR4.1: 页面大小

组件： QLabel ("页面大小") 和 QComboBox。

功能： 允许用户选择最终的纸张尺寸，例如 "A4 ( 210mm × 297mm )", "A5" 等。

联动： 更改此选项必须立即更新 FR3.1 和 FR3.3。

FR4.2: 页面方向

组件： 一个 QSwitch 或 QCheckBox 组，提供 "竖版" (Portrait) 和 "横版" (Landscape) 选项。

联动： 切换此选项必须立即更新 FR3.1 的画布比例和 FR3.3 中的 [W] 和 [H] 值。

FR4.3: 排序方式

组件： QRadioButton 组，提供 "横向排序" 和 "竖向排序"。

功能：

横向排序（默认）： 批量打印时，标签数据按 (1,1), (1,2), (1,3)... 的顺序填充。

竖向排序： 标签数据按 (1,1), (2,1), (3,1)... 的顺序填充。

联动： 此选项会影响最终打印和预览时标签的填充顺序。

FR4.4: 行数与列数

组件： 两个 QLabel、两个 QSlider（滑块）、两个 QSpinBox（数字输入框）。

功能：

"每页显示行数"：允许用户通过滑块或数字框设置行数（N）。

"每页显示列数"（截图中为“每行显示个数”）：允许用户设置列数（M）。

联动： QSlider 和 QSpinBox 必须双向绑定。更改任何一个的值必须立即更新 FR3.2 和 FR3.3。

FR4.5: 格子边距 (Cell Margin)

组件： QLabel ("格子边距 (单位: mm)") 和四个 QSpinBox (上, 下, 左, 右)。

功能： 定义标签内容在每个网格单元内部的留白（Padding）。这用于微调标签在格子里的位置。

联动： 更改此值应轻微调整 FR3.2 网格的内部视觉效果（如果预览足够精细）。

FR4.6: 页面边距 (Page Margin)

组件： QLabel ("页面边距 (单位: mm)") 和四个 QSpinBox (上, 下, 左, 右)。

功能： 定义整个网格区域距离 A4 纸张边缘的距离。

联动： 更改此值必须立即更新 FR3.2 中排版网格的整体位置和大小。

5.0 底部操作按钮
FR5.1: 确认操作

组件： 两个 QPushButton，"立即导出" 和 "立即打印"。

功能：

点击 "立即导出"：系统必须保存所有排版设置，关闭此对话框，并开始生成基于此布局的 PDF 文件。

点击 "立即打印"：系统必须保存所有排版设置，关闭此对话框，并开始将基于此布局的打印作业发送给 QPrinter。

联动： 这两个按钮应作为此对话框的 accept() 信号。如果用户直接关闭窗口 (X)，则应视为 reject()，所有设置不应保存。